# 事务 数据库连接池

## 事务
> Transaction   
指的是一组操作, 里面包含多个单一的操作. 如果有一个单一的操作有一个不通过, 那么整个事务都失败. 所有的数据都回滚到最初的状态.

* 事务的作用
> 为了确保逻辑的必须成功. eg: 银行的转账.[eg: ](file:///G:\cache\idea\java\databases\src\main\java\com\transaction\Demo1.java)  
代码中的事务, 是针对连接的. 通过
* conn.setAutoCommit(false) 关闭自动提交的设置
* conn.commit 提交事务
* conn.rollback 回滚事务

### 事务的特性
ACID
1. 原子性 : 事务中包含的逻辑不可分割
2. 一致性 : 事务执行前后, 数据的完整性保持一致
3. 隔离性 : 事务在执行期间, 不应该受到其他事务的影响
4. 持久性 : 事务执行成功, 数据应该持久保存到磁盘上.

### 事务的安全隐患
> 不考虑隔离级别设置, 会出现以下问题
* 读
    1. 脏读   隔离级别为"读未提交"
        * 一个事务读到了另一个事务还没有提交的数据
    2. 不可重复读 隔离级别设置为"读已提交"
        * 但是这个隔离级别导致了不可重复读. 一个事务读取到了另一个事务提交的数据, 造成了前后两次查询的结果不一致
    3. 幻读   一个事务读到了另一个事务已提交的插入的数据, 导致多次查询的结果不一致

* 写
    * 丢失更新
        * 解决方式
            1. 悲观锁  select * from account for update;
            2. 乐观锁  要求程序员自己控制

## 数据库连接池
> 一开始在内存中开辟一块空间, 一开始先在里面放置多个连接对象, 后面需要使用的时候, 直接往池子里面取.
不需要自己创建了. 使用之后, 在放回池子中.

## 开源的数据库连接池
1. DBCP
2. C3P0

## DBUtils